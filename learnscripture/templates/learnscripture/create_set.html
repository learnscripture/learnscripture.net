{% extends "base.html" %}

{% load form_rendering %}

{% block content %}

  {% if set_type == 'SELECTION' %}

    <div id="id-create-selection-set">

      <form id="id-verse-set-form" action="" method="POST">
        <input type="hidden" value="" id="id-internal-reference-list"  name="internal_reference_list">
        <h3>About this set</h3>
        {% csrf_token %}
        {{ verse_set_form|render_form }}

        <div id="id-verse-list">
          <h3>Verse list</h3>

          <div id="id-verse-list-empty-message">
            No verses added yet!
          </div>

          <table>
            <thead>
              <tr>
                <th>Reference</th>
                <th>Text</th>
              </tr>
            </thead>
            <tbody>
              {% for v in verses %}
                <tr data-internal-reference="{{ v.internal_reference }}">
                  <td>{{ v.localized_reference }}</td>
                  <td>{{ v.text }}</td>
                  <td><span title="move up"><i class="icon-arrow-up"></i></span></td>
                  <td><span title="move down"><i class="icon-arrow-down"></i></span></td>
                  <td><span title="remove"><i class="icon-trash"></i></span></td>
                </tr>
              {% endfor %}
            </tbody>
            <tfoot>
              <tr>
                <td colspan="5">
                  Drag/drop or use the arrows to re-order.
                </td>
              </tr>
            </tfoot>
          </table>
        </div>
      </form>

      {# See also "learnscripture/create_selection_row_inc.html" which is rendered by VerseFind API call #}

      <h3>Add verses</h3>

      {% include "learnscripture/quick_find_controls.html" %}

      {# See also "learnscripture/create_selection_results_inc.html" which is rendered by VerseFind API call #}

      <form>
        <hr>
        <div class="actions">
          <input name="save" type="submit" class="btn primary" value="Save verse set" id="id-save-btn">
        </div>
      </form>

    </div>

  {% endif %}

  {% if set_type == 'PASSAGE' %}

    <div id="id-create-passage-set">
      <h3>Choose passage</h3>

      {% with quick_find_mode='PASSAGE' %}
        {% include "learnscripture/quick_find_controls.html" %}
      {% endwith %}

      <div id="id-duplicate-warning"></div>

      {# See also "learnscripture/duplicate_passage_warning_inc.html" which is rendered by VerseFind API call #}

      <div id="id-verse-list">
        <p>For passages more than about 10 verses, it helps if you can indicate the
          natural breaks in the passage by ticking the 'Section break' box on the verses
          which start a new section or paragraph.</p>
        <p><b>NOTE:</b> section breaks are in <b>addition</b> to verse breaks to indicate <b>larger</b> sections.
          When learning, you will only ever be presented with one verse at a time, even if you do not add
          section breaks.</p>
        <table>
          <thead>
            <tr>
              <th>Section break</th>
              <th>Reference</th>
              <th>Text</th>
            </tr>
          </thead>
          <tbody>
            {% for v in verses %}
              <tr data-internal-reference="{{ v.internal_reference }}">
                <td><input type="checkbox" {% if v.break_here %}checked{% endif %}/></td>
                <td>{{ v.localized_reference }}</td>
                <td>{{ v.text }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>

      </div>

      {# See also "learnscripture/create_passage_row_inc.html" which is rendered by VerseFind API call #}

      <form id="id-verse-set-form" action="" method="POST">
        <input type="hidden" name="initial_localized_reference" value="{{ initial_localized_reference }}">
        {% csrf_token %}

        <h3>Optional extra info</h3>

        {% if verse_set_form.non_field_errors %}
          <p>The verse set could not be saved:</p>
        {% endif %}

        {{ verse_set_form|render_form }}

        <div class="actions">
          <input type="hidden" value="" id="id-internal-reference-list"  name="internal_reference_list">
          <input type="hidden" value="" id="id-break-list"  name="break_list">
          <input name="save" type="submit" class="btn primary" value="Save verse set" id="id-save-btn">
        </div>

      </form>
    </div>

  {% endif %}

{% endblock %}
